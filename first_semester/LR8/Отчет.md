
**Автор:** Александр Рябков, P3124

# Цель работы
Cделать простое, но работающее веб-приложение без использования фреймворков.
В итоговой программе есть:
- получение актуальных курсов валют через API ЦБ РФ
- страницы с выводом информации
- возможность создавать пользователей и оформлять подписки на валюты
- отображение динамики валют (изменение курса в процентах)
- графики изменения курса за последние 90 дней

# Описание предметной области

В проекте используется несколько основных моделей:

**User** — хранит имя, email и идентификатор.  
**UserSubscription** — подписка пользователя на определённую валюту. Содержит дату добавления и историю изменений курса.  
**Currency** — содержит название валюты, текущий курс, дату обновления и процент изменения.

Один пользователь может иметь несколько подписок, каждая подписка относится к конкретной валюте.

# Структура проекта
```
server.py          – обработка запросов, маршруты
render.py          – настройка Jinja2 и рендер HTML-шаблонов
models/
    user.py        – модель пользователя
    users.py       – работа со списком пользователей
    user_subscription.py   – подписки
    currency_api.py        – получение курсов и кэширование
templates/
    *.html         – шаблоны страниц
tests.py           – тесты

```

# Реализация

## Модели
реализованы в виде обычных Python-классов.  
Например, подписка хранит историю изменения курса:

```python
def add_history(self, rate):     self.history.append(rate)
```

Модели сделаны максимально простыми: без ORM и баз данных (см. ЛР 9), всё хранится в памяти, что облегчает понимание архитектуры и подчёркивает цель работы.

## Маршруты и обработка запросов

Используется стандартный `http.server`.  
Основные маршруты:
- `/` — главная страница
- `/users` — список пользователей + CRUD-операции
- `/user?id=` — профиль пользователя и его подписки
- `/currencies` — актуальные курсы валют

В маршрутах формируется контекст и передаётся в шаблон

## Использование Jinja2
Шаблонизатор подключён вручную:
```python
env = Environment(loader=FileSystemLoader("templates"), autoescape=True)
```

Через него рендерятся все HTML-страницы.

## Получение курсов валют

Используется функция `get_currencies()` + собственное кэширование архивов, чтобы программа работала быстро даже при большом количестве запросов.

## Графики

В профиле пользователя подключён Chart.js, куда передаются данные истории курса за 90 дней.

# Примеры работы
В приложении есть:
- главная страница с краткой информацией
<img width="1186" height="386" alt="Снимок экрана 2025-12-07 162223" src="https://github.com/user-attachments/assets/b6fe81e4-6745-458a-843e-b1791febf861" />
- таблица всех валют
<img width="1215" height="927" alt="Снимок экрана 2025-12-07 162234" src="https://github.com/user-attachments/assets/ec7d825a-cbc3-462b-96a4-a8f7b17606e1" />
- таблица пользователей
<img width="1230" height="1039" alt="Снимок экрана 2025-12-07 162300" src="https://github.com/user-attachments/assets/3eb408c2-dc27-49c8-87e3-5feeafedbf31" />
- страница конкретного пользователя с его подписками, курсами и графиками
<img width="1177" height="1069" alt="Снимок экрана 2025-12-07 162322" src="https://github.com/user-attachments/assets/afa3f655-8df4-4540-a95c-e104e8b6b579" />
<img width="1191" height="645" alt="Снимок экрана 2025-12-07 162336" src="https://github.com/user-attachments/assets/53e4bb33-49a1-400d-8f21-fd5235d61df5" />


# Самостоятельная работа

- реализована система кэширования архивных курсов (резко ускорило приложение)
- добавлены графики за 3 месяца
- добавлена автоматическая оценка процента изменения курса за сутки

# Тестирование
Написаны базовые тесты:
- проверка моделей (`User`, `UserSubscription`)
- проверка контроллера (`server.py`)
- тест функции `get_currencies()`

Пример:
```python
assert "USD" in get_currencies()
```

Все тесты выполняются корректно.

# Выводы
Во время работы удалось реализовать полноценную структуру MVC без использования фреймворков.  
Был получен опыт:
- работы с чистым `HTTPServer`
- рендеринга страниц через Jinja2
- взаимодействия с внешним API
- кэширования данных и оптимизации скорости работы
- построения графиков динамики курса
    

В итоге получилось удобное и довольно быстрое приложение, которое можно расширять дальше при необходимости.
